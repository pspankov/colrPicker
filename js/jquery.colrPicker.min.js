(function(a){a.fn.colrPicker=function(b){b=a.extend({},a.fn.colrPicker.defaults,b);b.duration;return this.each(function(){var E=a(this);if(b.hideInput){E.hide()}var C=a('<div class="colorPickTrigger" />').insertAfter(E);var n=false;var o=false;var P=false;var x=0;var z=0;var m;var l=false;if(E.val()!=""){E.val(t(E.val()));C.css("background-color",E.val());l=E.val()}var k=a('<div class="colrPicker" />').append('<div class="color-palette"><div class="circlePicker"><div class="circlePicker-inner"></div></div></div><div class="huebar"><div class="hueSlider"></div><div class="bar hue"></div></div><div class="satbar"><div class="satSlider"></div><div class="bar sat"></div></div><div class="britbar"><div class="britSlider"></div><div class="bar brit"></div></div><div class="color-info"><div class="hex" style="margin-right:8px"><label>HEX</label><input type="text" name="hex" class="hex-value" value="ffffff"></div><div><label>R</label><input type="text" name="red" value="255"></div><div><label>G</label><input type="text" name="green" value="255"></div><div style="margin-right:8px"><label>B</label><input type="text" name="blue" value="255"></div><div><label>H</label><input type="text" name="hue" value="360"></div><div><label>S</label><input type="text" name="sat" value="0"></div><div style="margin-right: 0";><label>B</label><input type="text" name="br" value="100"></div></div>');C.on("click",function(){if(!n){k.appendTo("body").hide();var U=L();k.css({top:U.top,left:U.left});k.fadeIn(b.fadeIn);if(l){c(l)}n=true}else{var U=L();k.css({top:U.top,left:U.left});k.fadeIn(b.fadeIn)}});var R=k.find(".color-palette").first();var r=k.find(".circlePicker").first();var T=k.find(".huebar").first();var i=k.find(".satbar").first();var J=k.find(".britbar").first();var q=k.find(".hueSlider").first();var A=k.find(".satSlider").first();var f=k.find(".britSlider").first();var H=k.find('input[name="hue"]').first();var N=k.find('input[name="sat"]').first();var O=k.find('input[name="br"]').first();var I=k.find('input[name="hex"]').first();var K=k.find('input[name="red"]').first();var y=k.find('input[name="blue"]').first();var M=k.find('input[name="green"]').first();k.find(":input").click(function(){a(this).select()});a(document).on("mousedown",function(){document.onselectstart=function(){return false}});k.children(".color-palette, .huebar, .satbar, .britbar").on("mousedown",function(U){if(U.which===1){o=true}z=U.pageX;x=U.pageY;m=a(this).attr("class");k.triggerHandler("mouseDragging",U)});a(document).mouseup(function(U){if(U.which===1){o=false;if(P){P=false}else{if(!k.is(U.target)&&!C.is(U.target)&&k.has(U.target).length===0){k.fadeOut(b.fadeOut)}}}});a(document).mousemove(function(U){if(o){if(!P){P=true}}if(P){k.triggerHandler("mouseDragging");z=U.pageX;x=U.pageY}});a(".colrPicker").onselectstart=function(){return false};k.bind("mouseDragging",function(U){if(m=="color-palette"){k.triggerHandler("draggingPalette",U)}if(m=="huebar"){k.triggerHandler("draggingHuebar",U)}if(m=="satbar"){k.triggerHandler("draggingSatbar",U)}if(m=="britbar"){k.triggerHandler("draggingBritbar",U)}g()});k.bind("draggingPalette",function(){var V=x-R.offset().top;var U=z-R.offset().left;if(V>150){V=150}if(V<0){V=0}if(U>150){U=150}if(U<0){U=0}r.css({top:V-7,left:U-7});A.css({top:U});N.val(Math.round(U/1.5));f.css({top:V});O.val(Math.round(100-V/1.5))});k.bind("draggingHuebar",function(){var U=x-T.offset().top;if(U>150){U=150}if(U<0){U=0}q.css({top:U});H.val(360-Math.round(U/(150/360)))});k.bind("draggingSatbar",function(){var U=x-i.offset().top;if(U>150){U=150}if(U<0){U=0}A.css({top:U});N.val(Math.round(U/1.5));r.css("left",U-7)});k.bind("draggingBritbar",function(){var U=x-J.offset().top;if(U>150){U=150}if(U<0){U=0}f.css({top:U});O.val(Math.round(100-U/1.5));r.css("top",U-7)});E.change(function(U){c(E.val())});I.change(function(U){c(I.val())});k.find('input[name="red"], input[name="green"], input[name="blue"]').change(function(){if(a(this).val()<0||a(this).val()>255||!/[0-9]/.test(a(this).val())){a(this).val(255)}s()});H.change(function(U){if(H.val()<0||H.val()>360||!/[0-9]/.test(H.val())){H.val(360)}S();g()});k.find('input[name="sat"], input[name="br"]').change(function(){if(a(this).val()<0||a(this).val()>100||!/[0-9]/.test(a(this).val())){a(this).val(0)}F();g()});function g(){var U=w({h:H.val(),s:N.val(),b:O.val()});h(U);var V=Q(U).toUpperCase();I.val(V);p(V);D()}function c(W){W=t(W).replace("#","");var V=j(W);h(V);var U=v(W);u(U);F();I.val(W);p(W);D()}function t(U){if(!/^#?([a-f0-9]{6})$/i.test(U)){U="#FFFFFF"}return U.toUpperCase()}function p(U){b.showHash?E.val("#"+U):E.val(U)}function s(){var V={r:parseInt(K.val()),g:parseInt(M.val()),b:parseInt(y.val())};var W=Q(V).toUpperCase();var U=B(V);u(U);I.val(W);p(W);F();D()}function u(U){H.val(U.h);N.val(U.s);O.val(U.b)}function h(U){K.val(U.r);M.val(U.g);y.val(U.b)}function D(){bg=w({h:H.val(),s:100,b:100});C.css("background-color","#"+I.val());R.css("background-color","rgb("+bg.r+","+bg.g+","+bg.b+")");i.css("background-color","rgb("+bg.r+","+bg.g+","+bg.b+")");J.css("background-color","rgb("+bg.r+","+bg.g+","+bg.b+")")}function F(){S();d();G()}function S(){q.css("top",150-H.val()*0.417)}function d(){r.css("left",N.val()*1.5-7);A.css("top",N.val()*1.5)}function G(){r.css("top",150-O.val()*1.5-7);f.css("top",150-O.val()*1.5)}function w(U){var W={};var aa=Math.round(U.h);var Z=Math.round(U.s*255/100);var V=Math.round(U.b*255/100);if(Z===0){W.r=W.g=W.b=V}else{var ab=V;var Y=(255-Z)*V/255;var X=(ab-Y)*(aa%60)/60;if(aa===360){aa=0}if(aa<60){W.r=ab;W.b=Y;W.g=Y+X}else{if(aa<120){W.g=ab;W.b=Y;W.r=ab-X}else{if(aa<180){W.g=ab;W.r=Y;W.b=Y+X}else{if(aa<240){W.b=ab;W.r=Y;W.g=ab-X}else{if(aa<300){W.b=ab;W.g=Y;W.r=Y+X}else{if(aa<360){W.r=ab;W.g=Y;W.b=ab-X}else{W.r=0;W.g=0;W.b=0}}}}}}}return{r:Math.round(W.r),g:Math.round(W.g),b:Math.round(W.b)}}function Q(U){var V=[U.r.toString(16),U.g.toString(16),U.b.toString(16)];a.each(V,function(W,X){if(X.length===1){V[W]="0"+X}});return V.join("")}function j(U){U=parseInt(((U.indexOf("#")>-1)?U.substring(1):U),16);return{r:U>>16,g:(U&65280)>>8,b:(U&255)}}function B(W){var V={h:0,s:0,b:0};var X=Math.min(W.r,W.g,W.b);var U=Math.max(W.r,W.g,W.b);var Y=U-X;V.b=U;V.s=U!==0?255*Y/U:0;if(V.s!==0){if(W.r===U){V.h=(W.g-W.b)/Y}else{if(W.g===U){V.h=2+(W.b-W.r)/Y}else{V.h=4+(W.r-W.g)/Y}}}else{V.h=-1}V.h=Math.round(V.h*60);if(V.h<0){V.h=Math.round(V.h+360)}V.s=Math.round(V.s*100/255);V.b=Math.round(V.b*100/255);return V}function v(V){var U=B(j(V));if(U.s===0){U.h=360}return U}function e(U){return Q(w(U))}function L(){var aa={};var V=C.offset().left;var X=C.offset().top;var U=parseInt(C.outerWidth());var Y=parseInt(C.outerHeight());var W=parseInt(k.outerWidth());var Z=parseInt(k.outerHeight());console.log(X);aa.left=((V+W)>window.innerWidth)?(V+U)-W:aa.left=V;aa.top=(X+Y+Z-a(window).scrollTop()>window.innerHeight)?X-Z:X+Y;return aa}})};a.fn.colrPicker.defaults={fadeIn:"fast",fadeOut:"fast",hideInput:false,showHash:true}})(jQuery);